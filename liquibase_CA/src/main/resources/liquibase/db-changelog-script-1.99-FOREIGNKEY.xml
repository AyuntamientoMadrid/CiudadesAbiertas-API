<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

<!-- No incluimos user, territorio y dsd que son maestras en la carga de fk -->

<!-- LOCAL COMERCIAL -->
	<changeSet author="Localidata" id="FK-agrupacion_comercial">
        <addForeignKeyConstraint 
			baseColumnNames="agrupacion_comercial" 
			baseTableName="local_comercial" 
			constraintName="fk_local_comercial_agrupacion" 
			referencedColumnNames="id" 
			referencedTableName="local_comercial_agrupacion"/>
    </changeSet>
    <changeSet author="Localidata" id="FK-tiene_terraza">
        <addForeignKeyConstraint 
			baseColumnNames="tiene_terraza" 
			baseTableName="local_comercial" 
			constraintName="fk_local_comercial_terraza" 
			referencedColumnNames="id" 
			referencedTableName="local_comercial_terraza"/>
    </changeSet>
    <changeSet author="Localidata" id="FK-tiene_licencia_apertura">
        <addForeignKeyConstraint 
			baseColumnNames="tiene_licencia_apertura" 
			baseTableName="local_comercial" 
			constraintName="fk_local_comercial_licencia"  
			referencedColumnNames="id" 
			referencedTableName="local_comercial_licencia"/>
    </changeSet>
	
	<!-- CALIDAD DEL AIRE -->
	<changeSet author="Localidata" id="FK-made-by-sensor-table-calidad-aire-observacion">
        <addForeignKeyConstraint baseColumnNames="made_by_sensor" baseTableName="calidad_aire_observacion" constraintName="fk_estacion"  referencedColumnNames="id" referencedTableName="calidad_aire_estacion"/>
    </changeSet>
	
	<changeSet author="Localidata" id="FK-made-by-sensor-table-calidad-aire-sensor">
        <addForeignKeyConstraint baseColumnNames="is_hosted_by" baseTableName="calidad_aire_sensor" constraintName="fk_estacion_sensor"  referencedColumnNames="id" referencedTableName="calidad_aire_estacion"/>
    </changeSet>
	
	
	<!-- Organigrama -->
	<changeSet author="Localidata" id="FK-UNIDAD-RAIZ">
        <addForeignKeyConstraint baseColumnNames="unidad_raiz" baseTableName="organigrama" constraintName="fk_unidad_raiz" referencedColumnNames="id" referencedTableName="organigrama"/>
    </changeSet>
	
	<changeSet author="Localidata" id="FK-UNIT-Of">
        <addForeignKeyConstraint baseColumnNames="unit_of" baseTableName="organigrama" constraintName="fk_unit_of"  referencedColumnNames="id" referencedTableName="organigrama"/>
    </changeSet>
	
	<!-- Callejero -->
	   <changeSet author="Localidata" id="FK-Index-table-callejero_tramo_via-via">
        <addForeignKeyConstraint baseColumnNames="via" baseTableName="callejero_tramo_via" constraintName="callejero_tramo_via_ibfk_1" referencedColumnNames="id" referencedTableName="callejero_via"/>
    </changeSet>
    
     <changeSet author="Localidata" id="FK-Index-table-portal_via-via">
        <addForeignKeyConstraint baseColumnNames="via" baseTableName="callejero_portal" constraintName="callejero_portal_ibfk_1" referencedColumnNames="id" referencedTableName="callejero_via"/>
    </changeSet>
	
	<!-- Agenda municipal -->
	<changeSet author="Localidata" id="FK-documento-to-evento">
        <addForeignKeyConstraint baseColumnNames="event_id" baseTableName="agenda_m_document" constraintName="fk_documento_to_evento"  referencedColumnNames="id" referencedTableName="agenda_m_evento"/>
    </changeSet>
	
	<changeSet author="Localidata" id="FK-rolEvento-to-evento">
        <addForeignKeyConstraint baseColumnNames="event_id" baseTableName="agenda_m_rolintegranteevento" constraintName="fk_rol_i_evento_to_evento"  referencedColumnNames="id" referencedTableName="agenda_m_evento"/>
    </changeSet>
	
	<changeSet author="Localidata" id="FK-eveto-to-evento">
        <addForeignKeyConstraint baseColumnNames="super_event_id" baseTableName="agenda_m_evento" constraintName="fk_evento_to_evento_super"  referencedColumnNames="id" referencedTableName="agenda_m_evento"/>
    </changeSet>
	
	
	<!-- Contratos -->
	 
	 <changeSet author="Localidata" id="fk-con-33">
        <addForeignKeyConstraint baseColumnNames="is_supplier_for" baseTableName="contratos_award" constraintName="contratos_award_ibfk_1" 
		referencedColumnNames="id" 	referencedTableName="contratos_organization"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-con-34">
        <addForeignKeyConstraint baseColumnNames="tender_id" baseTableName="contratos_lot" constraintName="contratos_lot_ibfk_1" referencedColumnNames="id" referencedTableName="contratos_tender"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-35">
        <addForeignKeyConstraint baseColumnNames="has_supplier" baseTableName="contratos_lot" constraintName="contratos_lot_ibfk_2" referencedColumnNames="id" referencedTableName="contratos_award"/>
    </changeSet>
    
    <changeSet author="Localidata" id="fk-con-36">
        <addForeignKeyConstraint baseColumnNames="lot_id" baseTableName="contratos_lot_rel_item" constraintName="contratos_lot_rel_item_ibfk_1" referencedColumnNames="id" referencedTableName="contratos_lot"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-37">
        <addForeignKeyConstraint baseColumnNames="item_id" baseTableName="contratos_lot_rel_item" constraintName="contratos_lot_rel_item_ibfk_2" referencedColumnNames="id" referencedTableName="contratos_item"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-38">
        <addForeignKeyConstraint baseColumnNames="has_tender" baseTableName="contratos_process" constraintName="contratos_process_ibfk_1" referencedColumnNames="id" referencedTableName="contratos_tender"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-39">
        <addForeignKeyConstraint baseColumnNames="is_buyer_for" baseTableName="contratos_process" constraintName="contratos_process_ibfk_2" referencedColumnNames="id" referencedTableName="contratos_organization"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-40">
        <addForeignKeyConstraint baseColumnNames="has_supplier" baseTableName="contratos_tender" constraintName="contratos_tender_ibfk_1" referencedColumnNames="id" referencedTableName="contratos_award"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-41">
        <addForeignKeyConstraint baseColumnNames="tender_id" baseTableName="contratos_tender_rel_item" constraintName="cont_tender_r_item_ibfk_1" referencedColumnNames="id" referencedTableName="contratos_tender"/>
    </changeSet>
    <changeSet author="Localidata" id="fk-con-42">
        <addForeignKeyConstraint baseColumnNames="item_id" baseTableName="contratos_tender_rel_item" constraintName="cont_tender_r_item_ibfk_2" referencedColumnNames="id" referencedTableName="contratos_item"/>
    </changeSet>
	
	<!-- DSD -->
	<changeSet author="Localidata" id="DSD_Tables-20">
        <addForeignKeyConstraint baseColumnNames="cube_key" baseTableName="cube_dsd_rel_dimension" constraintName="cube_dsd_rel_dim_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="cube_dsd"/>
    </changeSet>
    <changeSet author="Localidata" id="DSD_Tables-21">
        <addForeignKeyConstraint baseColumnNames="cube_key" baseTableName="cube_dsd_rel_measure" constraintName="cube_dsd_rel_mea_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="cube_dsd"/>
    </changeSet>
    <changeSet author="Localidata" id="DSD_Tables-22">
        <addForeignKeyConstraint baseColumnNames="measure_key" baseTableName="cube_dsd_rel_measure" constraintName="cube_dsd_rel_mea_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="cube_dsd_measure"/>
    </changeSet>
    <changeSet author="Localidata" id="DSD_Tables-23">
        <addForeignKeyConstraint baseColumnNames="dimension_key" baseTableName="cube_dsd_dimension_value" constraintName="dsd_dim_value_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="cube_dsd_dimension"/>
    </changeSet>
    <changeSet author="Localidata" id="DSD_Tables-24">
        <addForeignKeyConstraint baseColumnNames="dimension_key" baseTableName="cube_dsd_rel_dimension" constraintName="dsd_rel_dim_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="cube_dsd_dimension"/>
    </changeSet>
	
	<!-- Territorio -->
	<changeSet author="Localidata" id="TablasTerritorio-42">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_autonomia" constraintName="t_autonomia_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-43">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_barrio" constraintName="t_barrio_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-44">
        <addForeignKeyConstraint baseColumnNames="autonomia" baseTableName="territorio_barrio" constraintName="t_barrio_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_autonomia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-45">
        <addForeignKeyConstraint baseColumnNames="provincia" baseTableName="territorio_barrio" constraintName="t_barrio_ibfk_3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_provincia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-46">
        <addForeignKeyConstraint baseColumnNames="municipio" baseTableName="territorio_barrio" constraintName="t_barrio_ibfk_4" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_municipio"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-47">
        <addForeignKeyConstraint baseColumnNames="distrito" baseTableName="territorio_barrio" constraintName="t_barrio_ibfk_5" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_distrito"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-48">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_distrito" constraintName="t_distrito_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-49">
        <addForeignKeyConstraint baseColumnNames="autonomia" baseTableName="territorio_distrito" constraintName="t_distrito_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_autonomia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-50">
        <addForeignKeyConstraint baseColumnNames="provincia" baseTableName="territorio_distrito" constraintName="t_distrito_ibfk_3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_provincia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-51">
        <addForeignKeyConstraint baseColumnNames="municipio" baseTableName="territorio_distrito" constraintName="t_distrito_ibfk_4" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_municipio"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-52">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_municipio" constraintName="t_municipio_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-53">
        <addForeignKeyConstraint baseColumnNames="autonomia" baseTableName="territorio_municipio" constraintName="t_municipio_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_autonomia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-54">
        <addForeignKeyConstraint baseColumnNames="provincia" baseTableName="territorio_municipio" constraintName="t_municipio_ibfk_3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_provincia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-55">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_provincia" constraintName="t_provincia_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-56">
        <addForeignKeyConstraint baseColumnNames="autonomia" baseTableName="territorio_provincia" constraintName="t_provincia_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_autonomia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-57">
        <addForeignKeyConstraint baseColumnNames="pais" baseTableName="territorio_seccion" constraintName="t_seccion_ibfk_1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_pais"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-58">
        <addForeignKeyConstraint baseColumnNames="autonomia" baseTableName="territorio_seccion" constraintName="t_seccion_ibfk_2" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_autonomia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-59">
        <addForeignKeyConstraint baseColumnNames="provincia" baseTableName="territorio_seccion" constraintName="t_seccion_ibfk_3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_provincia"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-60">
        <addForeignKeyConstraint baseColumnNames="municipio" baseTableName="territorio_seccion" constraintName="t_seccion_ibfk_4" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_municipio"/>
    </changeSet>
    <changeSet author="Localidata" id="TablasTerritorio-61">
        <addForeignKeyConstraint baseColumnNames="distrito" baseTableName="territorio_seccion" constraintName="t_seccion_ibfk_5" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ikey" referencedTableName="territorio_distrito"/>
    </changeSet>
	
	<!-- Bicicleta Pública -->
	 
	 <changeSet author="Localidata" id="fk-bicicleta-01">
        <addForeignKeyConstraint baseColumnNames="estacion_bicicleta_id" baseTableName="bici_anclaje" constraintName="bibileta_anclaje_ibfk_1" 
		referencedColumnNames="id" 	referencedTableName="bici_estacion"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-02">
        <addForeignKeyConstraint baseColumnNames="usuario_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_1" 
		referencedColumnNames="id" 	referencedTableName="bici_usuario"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-03">
        <addForeignKeyConstraint baseColumnNames="bicicleta_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_2" 
		referencedColumnNames="id" 	referencedTableName="bici_bicicleta"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-04">
        <addForeignKeyConstraint baseColumnNames="estacion_bicicleta_origen_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_3" 
		referencedColumnNames="id" 	referencedTableName="bici_estacion"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-05">
        <addForeignKeyConstraint baseColumnNames="estacion_bicicleta_destino_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_4" 
		referencedColumnNames="id" 	referencedTableName="bici_estacion"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-06">
        <addForeignKeyConstraint baseColumnNames="anclaje_origen_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_5" 
		referencedColumnNames="id" 	referencedTableName="bici_anclaje"/>
     </changeSet>
	 <changeSet author="Localidata" id="fk-bicicleta-07">
        <addForeignKeyConstraint baseColumnNames="anclaje_destino_id" baseTableName="bici_trayecto" constraintName="bicicleta_trayecto_ibfk_6" 
		referencedColumnNames="id" 	referencedTableName="bici_anclaje"/>
     </changeSet>
	<changeSet author="Localidata" id="fk-bicicleta-08">
        <addForeignKeyConstraint baseColumnNames="trayecto_id" baseTableName="bici_punto_paso" constraintName="bicicleta_punto_de_paso_ibfk_1" 
		referencedColumnNames="id" 	referencedTableName="bici_trayecto"/>
     </changeSet>
	<changeSet author="Localidata" id="fk-bicicleta-09">
        <addForeignKeyConstraint baseColumnNames="made_by_sensor" baseTableName="bici_observacion" constraintName="bicicleta_observacion_ibfk_1" 
		referencedColumnNames="id" 	referencedTableName="bici_estacion"/>
     </changeSet>
	 
  	 
	
</databaseChangeLog>